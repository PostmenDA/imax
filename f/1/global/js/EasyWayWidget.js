var EasyWayWidget=EasyWayWidget||function(lb){function Qa(c){E=c.id||E;I=c.hash||I;x=c.container_id||x;J=c.width||J;Q=c.height||Q;q=c.lang||q;p=c.options||p;W=c.callback||W;aa=c.hidden||aa;oa=void 0!==c.show_address_tooltip_on_startup?c.show_address_tooltip_on_startup:oa;pa=void 0!==c.map_scroll_wheel?c.map_scroll_wheel:pa;K=void 0!==c.auto_zoom_on_startup?c.auto_zoom_on_startup:K;X=null==X?!0:!1;!X||E&&I&&x||R("MISSING_PARAMETER");f.start=null;f.stop=null;c.transport&&c.transport.mode&&(F=c.transport);
if(X){var b=[k+"/images/bus_green.png",k+"/images/bus_blue.png",k+"/images/metro_green.png",k+"/images/metro_blue.png",k+"/images/trol_green.png",k+"/images/trol_blue.png",k+"/images/tram_green.png",k+"/images/tram_blue.png",k+"/images/train_green.png",k+"/images/train_blue.png",k+"/images/boat_green.png",k+"/images/boat_blue.png",k+"/images/optimal_green.png",k+"/images/optimal_blue.png",k+"/images/fast_green.png",k+"/images/fast_blue.png",k+"/images/cheap_green.png",k+"/images/cheap_blue.png",k+
"/images/direct_green.png",k+"/images/direct_blue.png",k+"/images/auto_green.png",k+"/images/auto_tr.png",k+"/images/pub_tr.png"];if("undefined"!=typeof document.body)try{var e=document.createElement("div"),h=e.style;h.position="absolute";h.top=h.left=0;h.visibility="hidden";document.body.appendChild(e);e.innerHTML='<img src="'+b.join('" /><img src="')+'" />'}catch(g){}c.eWayJQuery?(a=c.eWayJQuery,qa()):mb(qa)}else ra(),qa()}function mb(c){"undefined"!=typeof jQuery?jQuery.fn.jquery!=nb?Ra(function(){sa(function(){a=
jQuery.noConflict(!0);c()})}):sa(function(){a=jQuery;c()}):Ra(function(){sa(function(){a=jQuery.noConflict();c()})})}function Sa(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent,b=b.toLowerCase();null!=/msie ([0-9]{1,}[.0-9]{0,})/.exec(b)&&(a=parseFloat(RegExp.$1))}return a}function Ra(a){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",ob);-1!=Sa()?b.onreadystatechange=function(){"complete"!=this.readyState&&
"loaded"!=this.readyState||a()}:b.onload=a;(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(b)}function sa(a){(function e(){if(!(ta>=ua.length)){var b=ta==ua.length-1?a:e,g=ua[ta++];if(document.getElementById(g))b();else{var r=document.createElement("script");r.setAttribute("type","text/javascript");r.setAttribute("src",g);r.setAttribute("src",g);-1!=Sa()?r.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()}:r.onload=b;(document.getElementsByTagName("head")[0]||
document.documentElement).appendChild(r)}}})()}function qa(){X&&(ba="eway_in_ua_map_div_"+Math.floor(1E9*Math.random()),aa&&a("#"+x).hide(),0>=a("#eway-widget-css").length&&a("<link>",{id:"eway-widget-css",rel:"stylesheet",type:"text/css",media:"all",href:pb}).appendTo("head"),a("<link>",{rel:"stylesheet",type:"text/css",media:"all",href:qb}).appendTo("head"),a("<link>",{rel:"stylesheet",type:"text/css",media:"all",href:rb}).appendTo("head"),a("<link>",{rel:"stylesheet",type:"text/css",media:"all",
href:sb}).appendTo("head"),a("<link>",{rel:"stylesheet",type:"text/css",media:"all",href:tb}).appendTo("head"),a("<link>",{rel:"stylesheet",type:"text/css",media:"all",href:ub}).appendTo("head"),a.getJSON(B+C,{act:"get_eway_root",id:E},function(a){L=a.eway_root}));a.getJSON(B+C,{act:"authorize",id:E,hash:I,lang:q||"get",token:ca()},function(c){void 0===c.error?(va=c.city.name,wa=c.city.currency,Ta=c.city.country_name,d=c.lang_data,da={},da.center_lng=c.city.center_lng,da.center_lat=c.city.center_lat,
n=c.addresses,c.city.no_routes?Y=!0:(y=c.city.key,ea=c.city.transport_types,ha=c.city.bound_zoom),vb(),q||(q=c.lang),J||0==J||(J=c.width),Q||(Q=c.height),p?0!=c.options.db_params?a.each(c.options,function(a,c){p[a]=c}):(a.each(p,function(a,b){c.options[a]=b}),p=c.options):p=c.options,ia=new google.maps.LatLng(c.center_lat,c.center_lng),X&&(fa=new ColorTheme(k,c.color,a)),wb(function(){var b=c.title;b||(b=d.header);a("#"+x).html("<div id='eway_widget_table'><div class='eway_widget_table_header'><div class='eway_widget_header_left'><div class='eway_widget_header_right'><div class='eway_widget_header'>"+
b+"</div></div></div></div><div class='eway_widget_map_wrapper' id='eway_widget_map_wrapper'><div class='eway_widget_map_wrap_border'><div class='eway_widget_container' id='"+ba+"'></div></div></div><div class='eway_widget_footer'>"+d.footer+"</div></div>");a("#"+x+" #eway_widget_map_wrapper").height(a("#"+x).height()-50);xb(c.zoom,c.map_error,c.places)})):R(c.error)})}function yb(c){a.each(c,function(a,c){var b=new google.maps.LatLng(c.x,c.y),g=c.name,r=c.address;v[a]={};v[a].name=g;v[a].address=
r;g=new google.maps.MarkerImage(k+"/images/"+c.image_url,new google.maps.Size(28,28),new google.maps.Point(0,0),new google.maps.Point(12,12));v[a].marker=new google.maps.Marker({map:l,position:b,clickable:!0,draggable:!1,icon:g,zIndex:101})});a.each(v,function(a,c){zb(a)})}function vb(){a.getJSON(B+C,{act:"get_all_stops",city_key:y},function(c){a.each(Ab(c.html),function(a,c){c.lat=Ua(c.lat);c.lng=Ua(c.lng);Va[c.id]={id:c.id,lat:c.lat,lng:c.lng,type:c.stop_type}});Wa(l,Xa)})}function Wa(c,b){var e=
c.getZoom(),h=e>ha?!0:!1;16>e&&(h=!1);var g=e-15;4<g&&(g=4);if(!1==h)a.each(b,function(a,c){c&&c.marker&&(c.markerTooltip.destroy(),c.marker.setMap(null),b[a]=null)});else{if(0<g){var r=12;switch(g){case 2:r=16;break;case 3:r=20;break;case 4:r=26}}a.each(Va,function(e,d){h=c.getBounds().contains(new google.maps.LatLng(d.lat,d.lng));if(!0==h){var s=new google.maps.MarkerImage(k+"/images/stops_icons/"+d.type+"_"+g+".png",new google.maps.Size(r,r),new google.maps.Point(0,0),new google.maps.Point(r/2,
r/2));if(!b[d.id]){var f=new google.maps.Marker({icon:s,type:"stop",position:new google.maps.LatLng(d.lat,d.lng),map:c,visible:h,zIndex:1}),u=new eway.GoogleMapTooltip("",f,{handlePosition:"top",stickOnTargetClick:!0,showOnMouseOver:!0,appearAfterTime:0,disappearAfterTime:0,holdOnMouseOver:!0,appearTime:0,disappearTime:0,width:0,tooltipIndent:10,hideOnSecondClick:!0,noContentPadding:!0,contentUrl:B+C,contentUrlParams:{act:"get_stop_popup",stop_id:d.id,city_key:y,lang:q},showCloseButton:!0,beforeTooltipShow:Ya,
jquery:a});u.setTooltip();G.push(u);A.push(f);b[d.id]={};b[d.id].marker=f;b[d.id].markerTooltip=u}b[d.id].marker.setIcon(s)}else b[d.id]&&(b[d.id].markerTooltip.destroy(),b[d.id].marker.setMap(null),b[d.id]=null)})}}function zb(c){var m=v[c].marker.getPosition().lat(),e=v[c].marker.getPosition().lng(),h=v[c].marker.getIcon().url,g;g="<TABLE class='place_popup' cellpadding='0' cellspacing='0'><TR>";g+="<TD class='place_popup_header_left'>";g+="<DIV class='place_popup_icon' style='background: url("+
h+") no-repeat;'></DIV>";g+="</TD>";g+="<TD class='place_popup_header_right' colspan='2'>";g+="<SPAN class='place_popup_place_name'><NOBR>"+v[c].name+"</NOBR></SPAN>";g+="<BR><SPAN class='place_popup_place_address'><NOBR>"+v[c].address+"</NOBR></SPAN>";g+="</TD>";g+="</TR>";g+="<TR>";g+="<TD class='place_popup_hr' colspan='3'></TD>";g+="</TR>";g+="<TR><TD colspan='2' class='place_popup_menu'>";g+="<DIV class='place_menu'><UL>";0>location.href.toLowerCase().indexOf("routes")&&(0!=p.show_to_point?g+=
"<LI class='place_menu_last_li'><A id='from_place_"+c+"' style='background: transparent url("+k+"/images/from_small_"+q+".png) no-repeat 22px 6px; color: #6F6F6F;'><NOBR>"+d.from_menu_text+"</NOBR></A></LI>":(g+="<LI class='place_menu_li'><A id='from_place_"+c+"' style='background: transparent url("+k+"/images/from_small_"+q+".png) no-repeat 22px 6px; color: #6F6F6F;'><NOBR>"+d.from_menu_text+"</NOBR></A></LI>",g+="<LI class='place_menu_last_li'><A id='to_place_"+c+"' style='background: transparent url("+
k+"/images/to_small_"+q+".png) no-repeat 22px 6px; color: #6F6F6F;'><NOBR>"+d.to_menu_text+"</NOBR></A></LI>"));g+="</UL></DIV>";g+="</TD></TR>";g+="</TABLE>";v[c].tooltip=new eway.GoogleMapTooltip(g,v[c].marker,{handlePosition:"bottom-left",stickOnTargetClick:!1,showCloseButton:!1,showOnMouseOver:!0,appearAfterTime:0,disappearAfterTime:0,holdOnMouseOver:!0,appearTime:0,disappearTime:0,width:0,tooltipIndent:-29,tooltipHorizontalIndent:19,hideOnSecondClick:!0,noContentPadding:!0,opacity:0.9,hideArrow:!0,
afterTooltipCreated:function(){var g=a("#from_place_"+c);if(g&&(g.click(function(){D("start",m,e,a("#eway_widget_from_input_active",b));v[c].tooltip.close();return!1}),g=a("#to_place_"+c)))return g.click(function(){D("stop",m,e,a("#eway_widget_to_input_active",b));v[c].tooltip.close();return!1}),!1}});v[c].tooltip.setTooltip()}function ca(){return function m(a){var b=Bb.charAt(Cb[a])+(21==a?"":m(a+1));0==a&&(base64=new Nibbler({dataBits:8,codeBits:6,keyString:Db,pad:"="}),b=base64.encode(eval(b)));
return b}(0)}function wb(a){ja=new google.maps.MarkerImage(k+"/images/"+fa.getColorName()+"/stop.png",new google.maps.Size(20,20),new google.maps.Point(0,0),new google.maps.Point(10,10));S=new google.maps.MarkerImage(k+"/images/"+fa.getColorName()+"/stop_transfer.png",new google.maps.Size(20,20),new google.maps.Point(0,0),new google.maps.Point(10,10));xa.start=new google.maps.MarkerImage(k+"/images/from_"+q+".png",new google.maps.Size(26,43),new google.maps.Point(0,0),new google.maps.Point(13,43));
xa.stop=new google.maps.MarkerImage(k+"/images/to_"+q+".png",new google.maps.Size(26,43),new google.maps.Point(0,0),new google.maps.Point(13,43));Za(a,0)}function Za(a,b){if(b==n.length)a();else{var e=k+"/"+n[b].logo,h=new Image;h.onload=function(){n[b].logoMarker=new google.maps.MarkerImage(e,new google.maps.Size(h.width,h.height),new google.maps.Point(0,0),new google.maps.Point(h.width/2,h.height));Za(a,b+1)};h.src=e}}function $a(c,b){var e=!1;a.each(n,function(a,g){if(n[a].id==c)return n[a].address?
b():(new google.maps.Geocoder).geocode({latLng:new google.maps.LatLng(n[a].point_lat,n[a].point_lng)},function(c,g){var e=Math.round(1E6*n[a].point_lat)/1E6,d=Math.round(1E6*n[a].point_lng)/1E6;n[a].address=e+":"+d;g==google.maps.GeocoderStatus.OK?c[0]&&(n[a].address=ga(c[0].formatted_address),b()):b()}),e=!0,!1});e||b()}function xb(c,b,e){c={zoom:c,minZoom:10,maxZoom:18,draggableCursor:"crosshair",draggingCursor:"crosshair",center:ia,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},
mapTypeControl:!1,panControl:!1,scaleControl:!1,streetViewControl:!0,overviewMapControl:!1,scrollwheel:pa};l=new google.maps.Map(document.getElementById(ba),c);c=new google.maps.StyledMapType([{featureType:"transit.station.bus",stylers:[{visibility:"off"}]}],{name:"Styled Map"});l.mapTypes.set("map_style",c);l.setMapTypeId("map_style");google.maps.event.addListener(l,"zoom_changed",function(){var c=l.zoom>ha?!0:!1;a.each(A,function(a,b){"stop"==b.type&&b.setVisible(c)});c||a.each(G,function(a,c){"stop"==
c.type&&c.close()})});google.maps.event.addListener(l,"bounds_changed",function(){Wa(l,Xa)});if(0!=p.show_to_point){if(K)var d=new google.maps.LatLngBounds;f.stop=[];a.each(n,function(c,b){var e=b.is_default?!0:!1;e&&(H=c);var m=new google.maps.Marker({icon:b.logoMarker,position:new google.maps.LatLng(b.point_lat,b.point_lng),map:l,draggable:0!=p.fix_to_point?!1:!0,addressID:b.id,addressKey:c,zIndex:1}),s=null;(function(){$a(b.id,function(){var b="<div class='padding'><div class='tooltip_company_name'>"+
n[c].company_name+"</div><div class='tooltip_company_address'><nobr>"+n[c].address+"</nobr></div></div>",d={handlePosition:"top-left",width:0,stickOnTargetClick:!0,hideOnSecondClick:!0,showOnMouseOver:!1,tooltipIndent:m.icon.size.height,showCloseButton:!0,stayVisible:oa?e:!1};s=new eway.GoogleMapTooltip(b,m,d);s.setTooltip();m.companyTooltip=s;google.maps.event.addListener(m,"dragstart",function(a){d.stayVisible=s.checkIfTooltipShown();s.close()});google.maps.event.addListener(m,"dragend",function(e){a.each(f.stop,
function(a,c){c.companyTooltip.close()});(new google.maps.Geocoder).geocode({latLng:e.latLng},function(r,h){var f=Math.round(1E6*e.latLng.lat())/1E6,k=Math.round(1E6*e.latLng.lng())/1E6,f=f+":"+k;h==google.maps.GeocoderStatus.OK&&r[0]&&(f=ga(r[0].formatted_address));n[c].address=f;n[c].point_lat=n[c].alg_lat=e.latLng.lat();n[c].point_lng=n[c].alg_lng=e.latLng.lng();s.destroy();b="<div class='padding'><div class='tooltip_company_name'>"+n[c].company_name+"</div><div class='tooltip_company_address'><nobr>"+
n[c].address+"</nobr></div></div>";s=new eway.GoogleMapTooltip(b,m,d);s.setTooltip();f=n[c].company_name+" ("+f+")";a("#eway_widget_to_input_active").val(f);a("#to_select option[value='"+m.addressID+"']").html(f);a("#to_select option[value='"+m.addressID+"']").attr("selected","selected");H=c});M();z()})})})();f.stop.push(m);K&&d.extend(m.getPosition())});K&&1<n.length&&l.fitBounds(d)}a(document).keydown(function(c){27==c.keyCode&&a("#"+ba).hasClass("widget_full_screen")&&ya()});google.maps.event.addListenerOnce(l,
"idle",function(){"NULL"===b?(0!=p.show_places&&0!=e.length&&yb(e),Eb()):(za(J),Aa(Q),K||l.setCenter(ia),R(b),W&&W(a))})}function ga(a){a=a.split(",");var b=a[0];isNaN(parseInt(a[1]))||(b+=", "+a[1]);return b}function za(c){0==c?a("#"+x).width("100%"):a("#"+x).width(c+"px");l&&google.maps.event.trigger(l,"resize");J=c}function Aa(c){a("#"+x).height(c);a("#"+x+" #eway_widget_map_wrapper").height(a("#"+x).height()-50);l&&google.maps.event.trigger(l,"resize");Q=c}function T(){return f.start.position.lat()}
function U(){return f.start.position.lng()}function N(c){return 0!=p.show_to_point?a("#eway_widget_tr_button",b).hasClass("auto")||c?n[1==f.stop.length?0:H].point_lat:n[1==f.stop.length?0:H].alg_lat:f.stop.position.lat()}function O(c){return 0!=p.show_to_point?a("#eway_widget_tr_button",b).hasClass("auto")||c?n[1==f.stop.length?0:H].point_lng:n[1==f.stop.length?0:H].alg_lng:f.stop.position.lng()}function ab(){return a("#eway_widget_from_input_active",b).val()}function bb(){return 0!=p.show_to_point?
n[1==f.stop.length?0:H].address:a("#eway_widget_to_input_active",b).val()}function ya(){a("#"+ba).toggleClass("widget_full_screen");a("#eway_widget_maximize",b).toggleClass("eway_widget_minimize_div");aa&&(a("#eway_widget_maximize",b).hasClass("eway_widget_minimize_div")?a("#"+x).show():a("#"+x).hide());var c=a("#eway_widget_maximize",b).hasClass("eway_widget_minimize_div")?d.minimize_tip:d.maximize_tip;Ba.setContent(c);c=l.getCenter();google.maps.event.trigger(l,"resize");l.setCenter(c);aa&&(l.setZoom(l.zoom+
1),l.setZoom(l.zoom-1))}function Eb(){b=document.createElement("div");Ca||(Ca="eway_widget_"+Math.floor(1E9*Math.random()));a(b).attr("id",Ca);b.index=1;a.getJSON(B+C,{act:"get_panel",id:E,hash:I,token:ca()},function(c){void 0===c.error?(a(b).html(c.html),a(b).ready(function(){var c=document.createElement("div");c.index=1;a(c).html("<div class='eway_widget_transparent_logo'></div>");l.controls[google.maps.ControlPosition.BOTTOM_LEFT].push(c);a("#eway_widget_maximize",b).click(function(){ya()});Da(a("#eway_widget_from_input_active",
b),function(c,e,m){inputElement=a("#eway_widget_from_input_active",b);a(inputElement).blur();a(inputElement).val(m);a(inputElement).removeClass("eway_widget_grey_text");D("start",c,e,inputElement)});Ea(a("#eway_widget_from_input_active",b));if(0!=p.show_to_point)if(Da(a("#eway_widget_from_input",b),function(c,e,m){inputElement=a("#eway_widget_from_input",b);inputElementActive=a("#eway_widget_from_input_active",b);a(inputElement).blur();a(inputElementActive).val(m);a(inputElementActive).removeClass("eway_widget_grey_text");
D("start",c,e,inputElementActive)}),Ea(a("#eway_widget_from_input",b)),1==f.stop.length)a("#eway_widget_to_input_active",b).attr("disabled","disabled"),a("#eway_widget_to_input_active",b).addClass("disabled"),$a(n[0].id,function(){a("#eway_widget_to_input_active",b).val(n[0].address)});else{var e="";a.each(n,function(a,c){e+="<option value='"+c.id+"'>"+c.company_name+" ("+c.address+")</option>"});a("#eway_widget_to_input_active",b).parent().html("<select id='to_select'>"+e+"</select>");a("#to_select",
b).change(function(){var c=a("#to_select option:selected").val();a.each(f.stop,function(a,b){b.addressID==c&&(H=b.addressKey,K||l.setCenter(b.getPosition()))});M();z();a(this).blur()})}else Da(a("#eway_widget_to_input_active",b),function(c,e,m){inputElement=a("#eway_widget_to_input_active",b);a(inputElement).blur();a(inputElement).val(m);a(inputElement).removeClass("eway_widget_grey_text");D("stop",c,e,inputElement)}),Ea(a("#eway_widget_to_input_active",b));if(Y){M();z();a("#eway_widget_tr_button",
b).removeClass("pub");a("#eway_widget_tr_button",b).addClass("auto");if(!V){var h={handlePosition:"bottom-right",stickOnTargetClick:!1,showCloseButton:!1,width:0,textAlign:"center",holdOnMouseOver:!1};V=new eway.SimpleYuiTooltip("eway_widget_tr_button");V.setTooltip(d.auto_tip,h)}a("#eway_widget_settings_button").addClass("eway_widget_settings_button_disabled_div")}else a("#eway_widget_tr_button",b).click(function(){M();z();a("#eway_widget_tr_button",b).hasClass("pub")?(a("#eway_widget_tr_button",
b).removeClass("pub"),a("#eway_widget_tr_button",b).addClass("auto"),V.setContent(d.auto_tip),a("#eway_widget_settings_button").addClass("eway_widget_settings_button_disabled_div")):a("#eway_widget_tr_button",b).hasClass("auto")&&(a("#eway_widget_tr_button",b).addClass("pub"),a("#eway_widget_tr_button",b).removeClass("auto"),V.setContent(d.pub_tip),a("#eway_widget_settings_button").removeClass("eway_widget_settings_button_disabled_div"))}),F&&"auto"===F.mode&&a("#eway_widget_tr_button",b).click();
0==p.show_to_point&&(a("#eway_widget_arrow_change_points",b).show(),a("#eway_widget_arrow_change_points",b).click(function(){var c=null,e=null,m=null,d=null;null!=f.start&&(c=f.start.position.lat(),e=f.start.position.lng());null!=f.stop&&(m=f.stop.position.lat(),d=f.stop.position.lng());f.start&&f.stop?(f.start.setMap(null),f.start=null,f.stop.setMap(null),f.stop=null,D("start",m,d,"#eway_widget_from_input_active",!0),D("stop",c,e,"#eway_widget_to_input_active",!0),c=a("#eway_widget_from_input_active",
b).val(),a("#eway_widget_from_input_active",b).val(a("#eway_widget_to_input_active",b).val()),a("#eway_widget_to_input_active",b).val(c)):f.start&&!f.stop?(f.start.setMap(null),f.start=null,D("stop",c,e,"#eway_widget_to_input_active",!0),a("#eway_widget_to_input_active",b).val(a("#eway_widget_from_input_active",b).val()),a("#eway_widget_to_input_active",b).hasClass("eway_widget_grey_text")&&a("#eway_widget_to_input_active",b).removeClass("eway_widget_grey_text"),P("#eway_widget_from_input_active")):
!f.start&&f.stop&&(f.stop.setMap(null),f.stop=null,D("start",m,d,"#eway_widget_from_input_active",!0),a("#eway_widget_from_input_active",b).val(a("#eway_widget_to_input_active",b).val()),a("#eway_widget_from_input_active",b).hasClass("eway_widget_grey_text")&&a("#eway_widget_from_input_active",b).removeClass("eway_widget_grey_text"),P("#eway_widget_to_input_active"))}),z());a("#eway_widget_site",b).click(function(){if(Y)window.open(L,"_blank");else{var a=L+"/"+q+"/cities/"+y;f.stop&&(f.start?(a+=
"/"+cb(),a+="/"+N()+":"+O(),a+="/"+T()+":"+U()+"/1"):a+="/"+N()+":"+O());window.open(a,"_blank")}});a("#eway_widget_print_button",b).click(function(){if(a("#eway_widget_tr_button",b).hasClass("pub")){var c=N(),e=O(),m=T(),d=U(),m=Math.round(1E6*m)/1E6,d=Math.round(1E6*d)/1E6,c=Math.round(1E6*c)/1E6,e=Math.round(1E6*e)/1E6,h=Number(a("#eway_widget_results_tabs div.eway_widget_results_tab_selected",b).html())-1;if("walk"==w[h].type)h=L+"/"+q+"/cities/"+(y||"other")+"/print/",h=h+(c+":"+e+"/")+(m+":"+
d+"/0"),window.open(h,"_blank");else if(f.start&&f.stop){var k=JSON.stringify(Fa),u=JSON.stringify(Ga),l=JSON.stringify(Ha),k=k.replace(/["']{1}/gi,""),u=u.replace(/["']{1}/gi,""),l=l.replace(/["']{1}/gi,""),h=L+"/"+q+"/cities/"+y+"/print/",h=h+(c+":"+e+"/"),h=h+(m+":"+d+"/"),h=h+(k+"/"+u+"/"+l);window.open(h,"_blank")}}else a("#eway_widget_tr_button",b).hasClass("auto")&&f.start&&f.stop&&(h=L+"/"+q+"/cities/"+(y||"other")+"/print/",h+=c+":"+e+"/",h+=m+":"+d+"/",h+=a("#eway_widget_results_tabs div.eway_widget_results_tab_selected",
b).html(),window.open(h,"_blank"));-1!=ka&&a.getJSON(B+C,{act:"register_print_click",stat_id:ka},function(){})});0!=p.show_mobile_banner&&(a("#eway_widget_mobile_banner",b).show(),a("#eway_widget_mobile_banner",b).attr("title",d.mobile_banner_alt),a(".eway_widget_mobile_banner_text",b).html(d.mobile_banner),a("#eway_widget_mobile_banner",b).click(function(){window.open(L+"/"+q+"/mobile","_blank")}));0!=p.advanced_results&&a("#eway_widget_results",b).addClass("eway_widget_results_large");a("#eway_widget_map",
b).html(d.map_type);a("#eway_widget_map",b).click(function(){Fb(a("#eway_widget_map_menu",b))});a("#eway_widget_menu_map_a",b).html(d.map_type);a("#eway_widget_menu_map_a",b).click(function(){l.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP});a("#eway_widget_map",b).html(d.map_type)});a("#eway_widget_menu_satellite_a",b).html(d.satellite_type);a("#eway_widget_menu_satellite_a",b).click(function(){l.setOptions({mapTypeId:google.maps.MapTypeId.HYBRID});a("#eway_widget_map",b).html(d.satellite_type)});
a("#eway_widget_from_image_activated",b).addClass("eway_widget_from_image_div_"+q);0!=p.show_to_point?(a("#eway_widget_from_image",b).addClass("eway_widget_from_image_div_"+q),1==f.stop.length?a("#eway_widget_to_image_activated",b).addClass("eway_widget_to_image_div_inactive_"+q):a("#eway_widget_to_image_activated",b).addClass("eway_widget_to_image_div_"+q)):a("#eway_widget_to_image_activated",b).addClass("eway_widget_to_image_div_"+q);google.maps.event.addListener(l,"click",function(a){la(a.latLng.lat(),
a.latLng.lng())});a("#eway_widget_clear_button_points, #eway_widget_clear_button_results",b).click(function(){db()});a("#eway_widget_build_way",b).click(function(){Z==ma?Ia():(a("#eway_widget_settings",b).hide(),a("#eway_widget_points",b).hide(),a("#eway_widget_splitter",b).removeClass("eway_widget_hidden"),a("#eway_widget_splitter_2",b).removeClass("eway_widget_hidden"),a("#eway_widget_ways_button",b).removeClass("eway_widget_ways_button_inactive_div"),a("#eway_widget_settings_button",b).removeClass("eway_widget_settings_button_inactive_div"),
a("#eway_widget_results",b).is(":visible")?(a("#eway_widget_results",b).hide(),a("#eway_widget_mobile_banner",b).css("top",31),Ja()):(a("#eway_widget_results",b).show(),a("#eway_widget_mobile_banner",b).css("top",0!=p.advanced_results?98:76),eb()))});a("#eway_widget_ways_button",b).click(function(){a("#eway_widget_results",b).hide();a("#eway_widget_settings",b).hide();a("#eway_widget_splitter",b).removeClass("eway_widget_hidden");a("#eway_widget_splitter_2",b).removeClass("eway_widget_hidden");a("#eway_widget_ways_button",
b).removeClass("eway_widget_ways_button_inactive_div");a("#eway_widget_settings_button",b).removeClass("eway_widget_settings_button_inactive_div");Z!=ma&&Ja();a("#eway_widget_points",b).is(":visible")?(a("#eway_widget_points",b).hide(),a("#eway_widget_mobile_banner",b).css("top",31)):(a("#eway_widget_points",b).show(),a("#eway_widget_mobile_banner",b).css("top",83),a("#eway_widget_ways_button",b).addClass("eway_widget_ways_button_inactive_div"),a("#eway_widget_splitter",b).addClass("eway_widget_hidden"))});
a("#eway_widget_settings_button",b).click(function(){a("#eway_widget_settings_button").hasClass("eway_widget_settings_button_disabled_div")||(a("#eway_widget_results",b).hide(),a("#eway_widget_points",b).hide(),a("#eway_widget_splitter",b).removeClass("eway_widget_hidden"),a("#eway_widget_splitter_2",b).removeClass("eway_widget_hidden"),a("#eway_widget_ways_button",b).removeClass("eway_widget_ways_button_inactive_div"),a("#eway_widget_settings_button",b).removeClass("eway_widget_settings_button_inactive_div"),
Z!=ma&&Ja(),a("#eway_widget_settings",b).is(":visible")?(a("#eway_widget_settings",b).hide(),a("#eway_widget_mobile_banner",b).css("top",31)):(a("#eway_widget_settings",b).show(),a("#eway_widget_mobile_banner",b).css("top",83),a("#eway_widget_settings_button",b).addClass("eway_widget_settings_button_inactive_div"),a("#eway_widget_splitter_2",b).addClass("eway_widget_hidden")))});a("#eway_widget_transports",b).html("");ea&&a.each(ea,function(c,e){a("#eway_widget_transports",b).append("<div class='eway_widget_settings_button' type='"+
c+"' id='eway_widget_"+c+"'></div>");a("#eway_widget_"+c,b).click(function(){a(this).toggleClass("disabled");var b=a(this).hasClass("disabled")?d.enable_tip:d.disable_tip;Ka[c].setContent(b+"<BR>"+e.accusative_name);z()});F&&F.types&&"public"==F.mode&&-1==a.inArray(c,F.types)&&a("#eway_widget_"+c,b).addClass("disabled")});a("#eway_widget_direct",b).click(function(){a(this).toggleClass("disabled");var c=a("#eway_widget_direct",b).hasClass("disabled")?d.enable_tip:d.disable_tip;La.setContent(c+d.direct_tip);
z()});F&&"public"==F.mode&&F.direct&&a("#eway_widget_direct",b).removeClass("disabled");a("#eway_widget_optimal",b).click(function(){a(this).hasClass("disabled")&&(a("#eway_widget_optimal",b).removeClass("disabled"),a("#eway_widget_fast",b).addClass("disabled"),a("#eway_widget_cheap",b).addClass("disabled"),z())});a("#eway_widget_fast",b).click(function(){a(this).hasClass("disabled")&&(a("#eway_widget_fast",b).removeClass("disabled"),a("#eway_widget_optimal",b).addClass("disabled"),a("#eway_widget_cheap",
b).addClass("disabled"),z())});a("#eway_widget_cheap",b).click(function(){a(this).hasClass("disabled")&&(a("#eway_widget_cheap",b).removeClass("disabled"),a("#eway_widget_fast",b).addClass("disabled"),a("#eway_widget_optimal",b).addClass("disabled"),z())});a("#eway_widget_transport_text",b).html(d.transport_type+":");a("#eway_widget_ways_text",b).html(d.way+":");a("#eway_widget_transfers_text",b).html(d.transfers+":");h={handlePosition:"bottom-right",stickOnTargetClick:!1,showCloseButton:!1,width:0,
textAlign:"center",holdOnMouseOver:!1};(new eway.SimpleYuiTooltip("eway_widget_question_mark")).setTooltip(d.question_tip,{handlePosition:"bottom-right",stickOnTargetClick:!1,showCloseButton:!1,width:350,textAlign:"justify",holdOnMouseOver:!1});Ba=new eway.SimpleYuiTooltip("eway_widget_maximize");Ba.setTooltip(d.maximize_tip,h);(new eway.SimpleYuiTooltip("eway_widget_site")).setTooltip(d.site_tip,h);(new eway.SimpleYuiTooltip("eway_widget_ways_button")).setTooltip(d.way_tip,h);Y||(new eway.SimpleYuiTooltip("eway_widget_settings_button")).setTooltip(d.settings_tip,
h);(new eway.SimpleYuiTooltip("eway_widget_clear_button_points")).setTooltip(d.clear_tip,h);(new eway.SimpleYuiTooltip("eway_widget_clear_button_results")).setTooltip(d.clear_tip,h);(new eway.SimpleYuiTooltip("eway_widget_print_button")).setTooltip(d.print_tip,h);ea&&a.each(ea,function(a,c){Ka[a]=new eway.SimpleYuiTooltip("eway_widget_"+a);Ka[a].setTooltip(d.disable_tip+"<BR>"+c.accusative_name,h)});(new eway.SimpleYuiTooltip("eway_widget_optimal")).setTooltip(d.optimal_tip,h);(new eway.SimpleYuiTooltip("eway_widget_fast")).setTooltip(d.fast_tip,
h);(new eway.SimpleYuiTooltip("eway_widget_cheap")).setTooltip(d.cheap_tip,h);La=new eway.SimpleYuiTooltip("eway_widget_direct");La.setTooltip(d.enable_tip+d.direct_tip,h);Y||(V=new eway.SimpleYuiTooltip("eway_widget_tr_button"),V.setTooltip(d.pub_tip,h));0!=p.show_to_point?fb():(M(),z());za(J);Aa(Q);K||l.setCenter(ia)})):R(c.error);W&&W(a)});l.controls[google.maps.ControlPosition.TOP_RIGHT].push(b)}function fb(){a("#eway_widget_panel_initial",b).show();a("#eway_widget_panel_activated",b).hide();
a("#eway_widget_points",b).hide();a("#eway_widget_results",b).hide();a("#eway_widget_settings",b).hide();a("#eway_widget_mobile_banner",b).css("top",31)}function M(){a("#eway_widget_panel_initial",b).hide();a("#eway_widget_panel_activated",b).show();a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_active");a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_inactive");a("#eway_widget_build_way_text",b).html(d.build);a("#eway_widget_points",b).show();a("#eway_widget_results",
b).hide();a("#eway_widget_settings",b).hide();a("#eway_widget_splitter",b).removeClass("eway_widget_hidden");a("#eway_widget_splitter_2",b).removeClass("eway_widget_hidden");a("#eway_widget_splitter",b).addClass("eway_widget_hidden");a("#eway_widget_ways_button",b).removeClass("eway_widget_ways_button_inactive_div");a("#eway_widget_ways_button",b).addClass("eway_widget_ways_button_inactive_div");a("#eway_widget_settings_button",b).removeClass("eway_widget_settings_button_inactive_div");a("#eway_widget_mobile_banner",
b).css("top",83)}function gb(){a("#eway_widget_panel_initial",b).hide();a("#eway_widget_panel_activated",b).show();a("#eway_widget_points",b).hide();a("#eway_widget_results",b).show();a("#eway_widget_settings",b).hide();a("#eway_widget_splitter",b).removeClass("eway_widget_hidden");a("#eway_widget_splitter_2",b).removeClass("eway_widget_hidden");a("#eway_widget_ways_button",b).removeClass("eway_widget_ways_button_inactive_div");a("#eway_widget_settings_button",b).removeClass("eway_widget_settings_button_inactive_div");
a("#eway_widget_mobile_banner",b).css("top",0!=p.advanced_results?98:76);eb()}function z(){a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_active");a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_inactive");a("#eway_widget_build_way_text",b).html(d.build);Z=ma}function Ja(){a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_active");a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_inactive");a("#eway_widget_build_way",b).addClass("eway_widget_build_way_active");
a("#eway_widget_build_way_text",b).html(d.variants);Z=Gb}function eb(){a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_active");a("#eway_widget_build_way",b).removeClass("eway_widget_build_way_inactive");a("#eway_widget_build_way",b).addClass("eway_widget_build_way_inactive");a("#eway_widget_build_way_text",b).html(d.variants);Z=Hb}function P(c){a(c).val(d.input_address);a(c).hasClass("eway_widget_grey_text")||a(c).addClass("eway_widget_grey_text")}function Ea(c){P(c);a(c).focus(function(){a(c).hasClass("eway_widget_grey_text")&&
(a(c).removeClass("eway_widget_grey_text"),a(c).val(""))});a(c).focusout(function(){""==a(c).val()&&P(c)})}function Da(c,b){new Autocomplete({elementID:c,source:Ib,select:function(a,c){b(c.item.lat,c.item.lng,c.item.value)},minLength:3,ROOT:k,jquery:a,langData:d})}function Ib(c,b){var e=Ta+" "+va+" "+c.term,d=new google.maps.LatLng(da.center_lat,da.center_lng),g=[];hb.geocode({address:e,location:d},function(e,d){if("OK"==d){var h=[];a.each(e,function(a,c){h.push({name:ga(c.formatted_address),lat:c.geometry.location.lat(),
lng:c.geometry.location.lng(),type:"ADDRESS"})});e=h;a.getJSON(B+C,{act:"get_stops_and_places",id:E,lang:q,term:c.term},function(c){var d=c.results;void 0!==c.error&&R(c.error);d&&(g=e.concat(d));g=Jb(Kb(g));b(a.map(g,function(a){return{name:a.name,value:a.name,lat:a.lat,lng:a.lng,type:a.type,info:a.info?a.info:"",image:a.image?a.image:null}}))})}})}function Jb(a){a.sort(function(a,c){return a.name>c.name?1:-1});return a}function Kb(c){var b=[],e={};a.each(c,function(a,c){e[c.type]||(e[c.type]={});
e[c.type][c.name]||c.name==va?"STOP"==c.type&&b.push(c):(e[c.type][c.name]=!0,b.push(c))});return b}function R(a){console&&console.error&&console.error("EasyWay Widget Error: "+a)}function Fb(c){a(document.body).click();if(!Ma&&!$){Na=Ma=!0;var b=a(c);$=!0;b.slideDown(200,function(){$=!1});a(document.body).bind("click",function(c){Na?Na=!1:$||($=!0,b.fadeOut(200,function(){$=!1}),a(document.body).unbind("click"),Ma=!1)})}}function ib(){var c="optimal";a("#eway_widget_fast",b).hasClass("disabled")||
(c="fast");a("#eway_widget_cheap",b).hasClass("disabled")||(c="cheap");return c}function Lb(){var c="false";a("#eway_widget_direct",b).hasClass("disabled")||(c="true");return c}function Mb(){var c=[];0<a("#eway_widget_metro",b).length&&!a("#eway_widget_metro",b).hasClass("disabled")&&c.push("metro");0<a("#eway_widget_train",b).length&&!a("#eway_widget_train",b).hasClass("disabled")&&c.push("train");0<a("#eway_widget_trol",b).length&&!a("#eway_widget_trol",b).hasClass("disabled")&&c.push("trol");0<
a("#eway_widget_tram",b).length&&!a("#eway_widget_tram",b).hasClass("disabled")&&c.push("tram");0<a("#eway_widget_bus",b).length&&!a("#eway_widget_bus",b).hasClass("disabled")&&c.push("bus");0<a("#eway_widget_boat",b).length&&!a("#eway_widget_boat",b).hasClass("disabled")&&c.push("boat");var d=c.length-1,e="[";a.each(c,function(a,c){e+='"'+c+'"';a!=d&&(e+=", ")});return e+="]"}function cb(){var c="",c=a("#eway_widget_boat",b).hasClass("disabled")?c+"0":c+"1",c=a("#eway_widget_tr_button",b).hasClass("auto")?
c+"1":c+"0",c=a("#eway_widget_trol",b).hasClass("disabled")?c+"0":c+"1",c=a("#eway_widget_bus",b).hasClass("disabled")?c+"0":c+"1",c=a("#eway_widget_tram",b).hasClass("disabled")?c+"0":c+"1",c=a("#eway_widget_metro",b).hasClass("disabled")?c+"0":c+"1",c=a("#eway_widget_train",b).hasClass("disabled")?c+"0":c+"1";switch(ib()){case "optimal":c+="100";break;case "fast":c+="010";break;case "cheap":c+="001"}var c=a("#eway_widget_direct",b).hasClass("disabled")?c+"0":c+"1",d,e=0,h=1;for(d=c.length-1;0<=
d;d--)"1"==c.charAt(d)&&(e+=h),h*=2;return e}function Ia(){if(null==f.start||null==f.stop)alert(d.specify_points);else{a("#eway_widget_build_way_text",b).html("<div class='eway_widget_loader_div'></div>");var c=cb();a("#eway_widget_tr_button",b).hasClass("pub")?a.getJSON(B+C,{act:"run",start_lat:T(),start_lng:U(),stop_lat:N(),stop_lng:O(),id:E,hash:I,lang:q,way_type:ib(),is_direct:Lb(),transport_types:Mb(),token:ca(),options:c,address_from:ab(),address_to:bb(),widget_address_id:0!=p.show_to_point?
n[H].id:0},function(c){if(void 0===c.error){gb();w=a.parseJSON(c.ways);ka=c.stat_id;a("#eway_widget_results_tabs",b).html("");a("#eway_widget_results_info",b).html(d.no_ways_found);for(c=1;c<=w.length;c++){var e="";1===c&&(e=" eway_widget_results_tab_selected");var h="result_"+c;a("#eway_widget_results_tabs",b).append("<div class='eway_widget_results_tab_div"+e+"' id='"+h+"'>"+c+"</div>");a("#"+h,b).bind("click",function(a){return function(){na(a-1)}}(c))}a("#eway_widget_results_transport",b).html("");
0!=w.length&&na(0)}else R(c.error)}):a("#eway_widget_tr_button",b).hasClass("auto")&&(a.getJSON(B+C,{act:"register_statistics",id:E,hash:I,token:ca(),start_lat:T(),start_lng:U(),stop_lat:N(),stop_lng:O(),options:c,address_from:ab(),address_to:bb(),widget_address_id:0!=p.show_to_point?n[H].id:0},function(a){void 0===a.error&&(ka=a.stat_id)}),Nb())}}function Nb(){gb();(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(T(),U()),destination:new google.maps.LatLng(N(),O()),travelMode:google.maps.TravelMode.DRIVING,
unitSystem:google.maps.UnitSystem.METRIC,provideRouteAlternatives:!0},function(c,f){"OK"==f&&(w=c.routes,a("#eway_widget_results_tabs",b).html(""),a("#eway_widget_results_info",b).html(d.no_ways_found),a.each(w,function(c,d){var g=0===c?" eway_widget_results_tab_selected":"",f=c+1,m="result_"+f;a("#eway_widget_results_tabs",b).append("<div class='eway_widget_results_tab_div"+g+"' id='"+m+"'>"+f+"</div>");a("#"+m,b).bind("click",function(a){return function(){na(a)}}(c))}),a("#eway_widget_results_transport",
b).html(""),0!=w.length&&(a("#eway_widget_results_tabs",b).append("<div class='eway_widget_results_tab_copyrights_div'>"+w[0].copyrights+"</div>"),na(0)))})}function jb(c,b){hb.geocode({latLng:c},function(e,d){var g=Math.round(1E6*c.lat())/1E6,f=Math.round(1E6*c.lng())/1E6,g=g+":"+f;d==google.maps.GeocoderStatus.OK&&e[0]&&(g=ga(e[0].formatted_address));a(b).removeClass("eway_widget_grey_text");a(b).val(g)})}function ga(a){a=a.split(",");var b=a[0];isNaN(parseInt(a[1]))||(b+=", "+a[1]);return b}function ra(){a.each(A,
function(a,b){null!=A[a]&&A[a].setMap(null)});a.each(G,function(a,b){null!=G[a]&&G[a].destroy()});G=[]}function Ya(){a.each(G,function(a,b){null!=G[a]&&G[a].close()})}function na(c){ra();var f=a(".eway_widget_results_tab_div",b);f.removeClass("eway_widget_results_tab_selected");a.each(f,function(c,b){a(b[0]).removeClass("eway_widget_results_tab_selected")});a(a(".eway_widget_results_tab_div",b).get(c)).addClass("eway_widget_results_tab_selected");if(a("#eway_widget_tr_button",b).hasClass("pub")){var f=
w[c].time,e=w[c].price,h=w[c].distance;a("#eway_widget_results_info",b).html(d.time+": "+f+" "+d.min+"\t"+d.price+": "+e+" "+wa+"\t"+d.distance+": "+h+" "+d.km);if("walk"==w[c].type)a("#eway_widget_results_transport",b).html("<div class='eway_widget_results_walk'>"+d.walk+"</div>"),Oa(w[c].way.routes[0],!0);else{var g=w[c].routes;Fa=[];Ga=[];Ha=[];t=[];Pa=0;a.each(g,function(c,e){(function(c){a.getJSON(B+C,{act:"load_route",lang:q,id:E,hash:I,route_id:g[c].id,start_pos:g[c].start,stop_pos:g[c].stop,
token:ca()},function(e){if(void 0===e.error){e=Ob(e.html);t[c]=e;Pa++;if(Pa==g.length){for(var d="",h=0;h<t.length;h++){var f=t[h].transport_name+" "+t[h].number;"metro"==t[h].type||"train"==t[h].type?f=t[h].number:368==t[h].id&&"kyiv"==y?f=t[h].number:82==t[h].id&&"zagreb"==y?f=t[h].number:153!=t[h].id||"odessa"!=y&&"odesa"!=y?73==t[h].id&&"sevastopol"==y&&(f=t[h].number):f=t[h].number;d+="<div class='eway_widget_results_"+t[h].type+"'>"+f+"</div>";h!=t.length-1&&(d+="<div class='float_left'>+</div>")}a("#eway_widget_results_transport",
b).html(d)}Oa(e)}else R(e.error)})})(c);Fa.push(parseInt(g[c].id,10));Ga.push(parseInt(g[c].start,10));Ha.push(parseInt(g[c].stop,10))})}}else a("#eway_widget_tr_button",b).hasClass("auto")&&(c=w[c],f=(c.legs[0].duration.value/60).toFixed(0),e=(c.legs[0].distance.value*Pb).toFixed(2),h=(c.legs[0].distance.value/1E3).toFixed(1),a("#eway_widget_results_info",b).html(d.time+": "+f+" "+d.min+"\t"+d.price+": "+e+" "+wa+"\t"+d.distance+": "+h+" "+d.km),a("#eway_widget_results_transport",b).html("<div class='eway_widget_results_auto'>"+
d.auto+"</div>"),Oa(c))}function Ua(a){var b=a+"",e=b.split(".");if(1<e.length){sBeforePointPart=e[0];sAfterPointPart=e[1];iAfterPointPartLength=sAfterPointPart.length;if(3<iAfterPointPartLength){sNewAfterPointPart="";sNewAfterPointPart+=sAfterPointPart[0];for(a=2;a<iAfterPointPartLength;a++)sNewAfterPointPart+=sAfterPointPart[a];sNewAfterPointPart+=sAfterPointPart[1];b=sBeforePointPart+"."+sNewAfterPointPart}a=+b}return a}function Ob(a){var b=0,e=0,d=jQuery.parseJSON,g=null,f="",k=new function(a){var c,
b,e,d,h,g,f,k,m,l;m=function(a,c){for(var b;0!==c;)b=c,c=a%c,a=b;return a};l=function(a,b,e,m){var l,r,n,s,u,p,q,t;t=function(a){m?h?q.push(a):q.push(String.fromCharCode(a)):q.push(d.charAt(a))};p=u=0;q=[];r=a.length;for(l=0;l<r;l+=1){p+=b;if(m)if(n=a.charAt(l),s=d.indexOf(n),n===c)break;else{if(0>s)throw'the character "'+n+'" is not a member of '+d;}else if(s=h?a[l]:a.charCodeAt(l),(s|k)!==k)throw s+" is outside the range 0-"+k;for(u=u<<b|s;p>=e;)p-=e,t(u>>p),u&=g[p]}if(!m&&0<p)for(t(u<<e-p),r=q.length%
f,l=0;l<r;l+=1)q.push(c);return h&&m?q:q.join("")};this.encode=function(a){return l(a,b,e,!1)};this.decode=function(a){return l(a,e,b,!0)};(function(){var l,r,n;c=a.pad||"";b=a.dataBits;e=a.codeBits;d=a.keyString;h=a.arrayData;r=Math.max(b,e);n=0;g=[];for(l=0;l<r;l+=1)g.push(n),n+=n+1;k=n;f=b/m(b,e)})()}({dataBits:8,codeBits:6,keyString:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pad:"="}),l={0:2,1:1,2:-4,3:4,4:1,5:-3};a=k.decode(a);b=a.length;for(e=0;e<b;e++)g=a.charCodeAt(e),
g-=l[e%6],f+=String.fromCharCode(g);f=k.decode(f);return d(f)}function Ab(a){var b=0,e=0,d=jQuery.parseJSON,g=null,f="",l=new function(a){var c,b,e,d,f,h,g,l,k,m;k=function(a,c){for(var b;0!==c;)b=c,c=a%c,a=b;return a};m=function(a,b,e,k){var m,n,p,r,q,s,u,t;t=function(a){k?f?u.push(a):u.push(String.fromCharCode(a)):u.push(d.charAt(a))};s=q=0;u=[];n=a.length;for(m=0;m<n;m+=1){s+=b;if(k)if(p=a.charAt(m),r=d.indexOf(p),p===c)break;else{if(0>r)throw'the character "'+p+'" is not a member of '+d;}else if(r=
f?a[m]:a.charCodeAt(m),(r|l)!==l)throw r+" is outside the range 0-"+l;for(q=q<<b|r;s>=e;)s-=e,t(q>>s),q&=h[s]}if(!k&&0<s)for(t(q<<e-s),n=u.length%g,m=0;m<n;m+=1)u.push(c);return f&&k?u:u.join("")};this.encode=function(a){return m(a,b,e,!1)};this.decode=function(a){return m(a,e,b,!0)};(function(){var m,n,r;c=a.pad||"";b=a.dataBits;e=a.codeBits;d=a.keyString;f=a.arrayData;n=Math.max(b,e);r=0;h=[];for(m=0;m<n;m+=1)h.push(r),r+=r+1;l=r;g=b/k(b,e)})()}({dataBits:8,codeBits:6,keyString:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
pad:"="}),k={0:2,1:1,2:-4,3:4,4:1,5:-3};a=l.decode(a);b=a.length;for(e=0;e<b;e++)g=a.charCodeAt(e),g-=k[e%6],f+=String.fromCharCode(g);f=l.decode(f);return d(f)}function kb(a){var b=a+"",e=b.split(".");if(1<e.length){sBeforePointPart=e[0];sAfterPointPart=e[1];iAfterPointPartLength=sAfterPointPart.length;if(3<iAfterPointPartLength){sNewAfterPointPart="";sNewAfterPointPart+=sAfterPointPart[0];for(a=2;a<iAfterPointPartLength;a++)sNewAfterPointPart+=sAfterPointPart[a];sNewAfterPointPart+=sAfterPointPart[1];
b=sBeforePointPart+"."+sNewAfterPointPart}a=+b}return a}function db(){ra();null!=f.start&&(f.start.setMap(null),f.start=null);P(a("#eway_widget_from_input",b));P(a("#eway_widget_from_input_active",b));0!=p.show_to_point?fb():(null!=f.stop&&(f.stop.setMap(null),f.stop=null),P(a("#eway_widget_from_input_active",b)),P(a("#eway_widget_to_input_active",b)),M(),z())}function D(a,b,e,d,g){M();z();if(null==f[a]){var k=d?!0:!1;f[a]=new google.maps.Marker({icon:xa[a],position:new google.maps.LatLng(b,e),map:l,
draggable:k,zIndex:1001});k&&google.maps.event.addListener(f[a],"dragend",function(){M();z();jb(f[a].getPosition(),d)})}else f[a].setPosition(new google.maps.LatLng(b,e));g||jb(f[a].getPosition(),d)}function la(c,d){null==f.start||0!=p.show_to_point?D("start",c,d,a("#eway_widget_from_input_active",b)):null==f.stop&&D("stop",c,d,a("#eway_widget_to_input_active",b))}function Oa(c,f){var e=new google.maps.Polyline({clickable:!1,type:"poly",strokeColor:fa.getColor(),strokeOpacity:0.7,strokeWeight:8,map:l,
zIndex:3}),h=new google.maps.Polyline({clickable:!1,type:"polyWhite",strokeColor:"#FFFFFF",strokeOpacity:0.3,strokeWeight:10,map:l,zIndex:2});A.push(e);A.push(h);if(f)(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(T(),U()),destination:new google.maps.LatLng(N(!0),O(!0)),travelMode:google.maps.TravelMode.WALKING,unitSystem:google.maps.UnitSystem.METRIC,provideRouteAlternatives:!1},function(c,b){if("OK"==b){var d=c.routes[0],f=new google.maps.LatLngBounds,g="start";a.each(d.legs[0].steps,
function(c,b){a.each(b.path,function(a,c){f.extend(c);e.getPath().push(c);h.getPath().push(c);if("start"==g){var b=new google.maps.Marker({icon:S,position:c,map:l,zIndex:4});A.push(b)}g=c})});d=new google.maps.Marker({icon:S,position:g,map:l,zIndex:4});A.push(d);l.fitBounds(f)}});else if(a("#eway_widget_tr_button",b).hasClass("pub")){var g=c.points,k=g.length-1,n=l.zoom>ha?!0:!1,p=new google.maps.LatLngBounds;a.each(g,function(b,f){f.lat=kb(f.lat);f.lng=kb(f.lng);if("true"==f.is_stop){var g=new google.maps.Marker({icon:0==
b||b==k?S:ja,type:0==b||b==k?"transfer":"stop",position:new google.maps.LatLng(f.lat,f.lng),map:l,markerTitle:f.title,visible:0==b||b==k?!0:n,zIndex:4}),m={handlePosition:"top",stickOnTargetClick:!0,showOnMouseOver:!0,appearAfterTime:0,disappearAfterTime:0,holdOnMouseOver:!0,appearTime:0,disappearTime:0,width:0,tooltipIndent:10,hideOnSecondClick:!0,noContentPadding:!0,contentUrl:B+C,contentUrlParams:{act:"get_stop_popup",stop_id:f.id,city_key:y,lang:q},showCloseButton:!0,beforeTooltipShow:Ya,jquery:a},
m=new eway.GoogleMapTooltip("",g,m);m.type=0==b||b==k?"transfer":"stop";m.setTooltip();G.push(m);A.push(g);0==b&&("metro"==c.type&&(c.number=d.metro),g="<table cellpadding='0' cellspacing='0' style='padding:0;margin:0;border:0;border-spacing:0;' class='tooltip'><tr><td class='left' style='padding:0;margin:0;border:0;border-spacing:0;'></td><td class='center' colspan='2' style='padding:0;margin:0;border:0;border-spacing:0;'><div class='padding'><div class='text'>"+("<nobr><a class='tooltip-route-link' target='_blank' href='"+
L+"/"+q+"/cities/"+y+"/routes/"+c.id+"'><span class='result_transport result_"+c.type+"'>"+c.number+"</span></a></nobr>")+"</div></div></td><td class='right' style='padding:0;margin:0;border:0;border-spacing:0;'></td></tr></table>",m={map:l,position:new google.maps.LatLng(f.lat,f.lng),handlePosition:"top-left",width:0,stickOnTargetClick:!1,showCloseButton:!1,tooltipIndent:10},g=new eway.GoogleMapTooltip(g,null,m),g.setTooltip(),A.push(g));p.extend(new google.maps.LatLng(f.lat,f.lng))}p.extend(new google.maps.LatLng(T(),
U()));p.extend(new google.maps.LatLng(N(),O()));l.fitBounds(p);e.getPath().push(new google.maps.LatLng(f.lat,f.lng));h.getPath().push(new google.maps.LatLng(f.lat,f.lng))})}else a("#eway_widget_tr_button",b).hasClass("auto")&&(l.fitBounds(c.bounds),k=c.overview_path.length-1,a.each(c.overview_path,function(a,c){e.getPath().push(c);h.getPath().push(c);if(0==a||a==k){var b=new google.maps.Marker({icon:S,position:c,map:l,zIndex:4});A.push(b)}}))}var k="http://widget.easyway.info",B=k+"/widget.php",L=
"",pb=k+"/css/widget.css?3",qb=k+"/css/tooltips.css?4",rb=k+"/css/YuiTooltip.css?4",sb=k+"/css/StopPopup.css?16",tb=k+"/css/PlacePopup.css?7",ub=k+"/css/eway-autocomplete.css?2",Cb=[40,12,7,5,22,2,14,31,43,35,12,7,36,0,6,12,14,43,32,11,33,16],Db="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C="?callback=?",ob=k+"/js/jquery-1.6.2.min.js",nb="1.6.2",Pb=0.00168,ua=["http://yui.yahooapis.com/3.14.1/build/yui/yui-min.js",k+"/js/jquery-ui-1.8.16.custom.min.js?1",k+"/js/Autocomplete.js?2",
k+"/js/Nibbler.min.js?1",k+"/js/json2.js?1",k+"/js/ColorTheme.js?1",k+"/js/SimpleYuiTooltip.js?1",k+"/js/GoogleMapYuiTooltip.js?10"],ta=0,ba=null,Ca=null,b=null,a,v=[],Xa={},Va={},Z=null,ma=1,Gb=2,Hb=3,p=null,ja=null,S=null,xa=[],d=null,Ma=!1,$=!1,Na=!1,l=null,hb=new google.maps.Geocoder,A=[],G=[],fa=null,f=[];f.start=null;var ia=f.stop=null,va=null,y=null,Ta=null,da=null,ea=null,Ka={},La=null,V=null,Ba=null,wa=null,w=[],Fa=[],Ga=[],Ha=[],t=[],Pa=0,Bb="the quick brown fox jumps over the lazy dog.",
X=null,E=null,I=null,J=0,Q=null,x=null,W=null,F=null,aa=null,oa=!0,pa=!0,K=!1,q=null,n=null,H=null,ha=12,Y=!1,ka=-1;Qa(lb);return{SetWidth:function(a){za(a)},SetHeight:function(a){Aa(a)},GetOverlays:function(){return A},GetMarkerImageStop:function(){return ja},SetMarkerImageStop:function(a){ja=a},GetMarkerImageTransfer:function(){return S},SetMarkerImageTransfer:function(a){S=a},GetColorTheme:function(){return fa},GetRoot:function(){return k},Init:function(a){Qa(a)},Run:function(c){function d(c){c.transport&&
c.transport.mode&&("auto"==c.transport.mode?a("#eway_widget_tr_button",b).hasClass("auto")||a("#eway_widget_tr_button",b).click():"public"!=c.transport.mode||Y||(a("#eway_widget_tr_button",b).hasClass("auto")&&a("#eway_widget_tr_button",b).click(),c.transport.types&&(a(".eway_widget_settings_button",b).addClass("disabled"),a("#eway_widget_optimal",b).removeClass("disabled"),a.each(c.transport.types,function(c,d){a("#eway_widget_"+d,b).removeClass("disabled")})),c.transport.direct?a("#eway_widget_direct",
b).removeClass("disabled"):a("#eway_widget_direct",b).addClass("disabled")))}c.lat&&c.lng?(c.address_id&&a.each(f.stop,function(a,b){if(b.addressID==c.address_id){var d=new google.maps.LatLngBounds;d.extend(new google.maps.LatLng(c.lat,c.lng));d.extend(b.getPosition());l.fitBounds(d);google.maps.event.trigger(b,"click")}}),d(c),a("#eway_widget_from_input_active",b).removeClass("eway_widget_grey_text"),a("#eway_widget_from_input_active",b).val("???"),la(c.lat,c.lng),Ia()):c.start&&c.stop&&0==p.show_to_point&&
(db(),c.start.lat&&c.start.lng&&c.stop.lat&&c.stop.lng&&(d(c),a("#eway_widget_from_input_active",b).removeClass("eway_widget_grey_text"),a("#eway_widget_from_input_active",b).val("???"),la(c.start.lat,c.start.lng),a("#eway_widget_to_input_active",b).removeClass("eway_widget_grey_text"),a("#eway_widget_to_input_active",b).val("???"),la(c.stop.lat,c.stop.lng),Ia()))},GetMap:function(){return l},Maximize:function(){ya()}}};
